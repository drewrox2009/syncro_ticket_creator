!function(){"use strict";var e,t,n,o,c={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"},58394:function(e,t,n){e.exports=n.p+"fd6ebc4970a52eece689.css"}},s={};function r(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return c[e](n,n.exports,r),n.exports}r.m=c,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r.b=document.baseURI||self.location.href,function(){const e=new MutationObserver((n=>{n.forEach((n=>{"childList"===n.type&&n.addedNodes.length>0&&(function(){const e=document.getElementById("save-settings");e?(e.addEventListener("click",t),console.log("settings.ts: Event listener attached to save-settings button")):console.error("settings.ts: Element with id 'save-settings' not found")}(),e.disconnect())}))}));async function t(){console.log("settings.ts: saveSettings called");const e=document.getElementById("syncro-url").value,t=document.getElementById("syncro-api-key").value;try{await n(e,t),console.log("settings.ts: Settings saved successfully"),window.close()}catch(e){console.error("settings.ts: Error saving settings:",e),alert("Error saving settings: "+e.message)}}function n(e,t){return console.log("settings.ts: saveSyncroSettings called",{syncroUrl:e,syncroApiKey:t}),new Promise(((n,o)=>{if("undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings)try{Office.context.roamingSettings.set("syncroUrl",e),Office.context.roamingSettings.set("syncroApiKey",t),Office.context.roamingSettings.saveAsync((e=>{e.status===Office.AsyncResultStatus.Succeeded?n():o(new Error("Error saving settings in Office environment: "+JSON.stringify(e.error)))}))}catch(e){o(new Error("Error saving settings in Office environment: "+e.message))}else try{localStorage.setItem("syncroUrl",e),localStorage.setItem("syncroApiKey",t),n()}catch(e){o(new Error("Error saving settings in local storage: "+e.message))}}))}let o,c;function s(){console.log("Syncro Ticket Creator: initializeApp called"),async function(){console.log("Syncro Ticket Creator: loadSyncroSettings called");const e=function(){console.log("settings.ts: getSyncroSettings called");let e="",t="";return"undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings?(e=Office.context.roamingSettings.get("syncroUrl")||"",t=Office.context.roamingSettings.get("syncroApiKey")||""):(e=localStorage.getItem("syncroUrl")||"",t=localStorage.getItem("syncroApiKey")||""),console.log("settings.ts: Retrieved settings:",{syncroUrl:e,syncroApiKey:t}),{syncroUrl:e,syncroApiKey:t}}();console.log("Retrieved settings:",e),o=e.syncroApiKey,c=e.syncroUrl,function(){console.log("Syncro Ticket Creator: showSettingsUI called");const e=document.getElementById("app-body");e?(console.log("Syncro Ticket Creator: app-body element found"),e.innerHTML=`\n      <h2>Syncro API Settings</h2>\n      <div class="ms-TextField">\n        <label class="ms-Label" for="syncro-url">Syncro URL</label>\n        <input type="text" id="syncro-url" class="ms-TextField-field" value="${c||""}" required />\n      </div>\n      <div class="ms-TextField">\n        <label class="ms-Label" for="syncro-api-key">Syncro API Key</label>\n        <input type="password" id="syncro-api-key" class="ms-TextField-field" value="${o||""}" required />\n      </div>\n      <div class="ms-TextField">\n        <button id="save-settings" class="ms-Button ms-Button--primary">\n          <span class="ms-Button-label">Save Settings</span>\n        </button>\n        <button id="test-api-settings" class="ms-Button ms-Button--secondary">\n          <span class="ms-Button-label">Test API Settings</span>\n        </button>\n      </div>\n    `,document.getElementById("save-settings").onclick=r,document.getElementById("test-api-settings").onclick=i,console.log("Syncro Ticket Creator: Settings UI rendered")):console.error("Syncro Ticket Creator: Element with id 'app-body' not found")}()}(),document.getElementById("create-ticket").onclick=l}async function r(){console.log("Syncro Ticket Creator: saveSettings called");const e=document.getElementById("syncro-url").value,t=document.getElementById("syncro-api-key").value;if(e&&t)try{await n(e,t),c=e,o=t,u("Settings saved successfully. Initializing app...","success"),await async function(){console.log("Syncro Ticket Creator: verifyApiSettings called");try{await d()}catch(e){throw console.error("Error verifying API settings:",e),new Error("Invalid API settings. Please check your Syncro URL and API Key.")}}(),await async function(){console.log("Syncro Ticket Creator: populateCustomers called");try{const e=await d(),t=document.getElementById("customer-select");if(!t)return void console.error("Syncro Ticket Creator: Element with id 'customer-select' not found");t.innerHTML='<option value="">Select a customer</option>',e.forEach((e=>{const n=document.createElement("option");n.value=e.id.toString(),n.textContent=g(e.name),t.appendChild(n)})),t.onchange=a}catch(e){throw console.error("Error populating customers:",e),u("Failed to load customers. Please check your Syncro settings.","error"),e}}(),y()}catch(e){console.error("Error saving settings:",e),u("Failed to save settings. Please try again.","error")}else u("Please enter both Syncro URL and API Key.","error")}async function i(){console.log("Syncro Ticket Creator: testApiSettings called");const e=document.getElementById("syncro-url").value,t=document.getElementById("syncro-api-key").value;if(e&&t)try{const n=await fetch(`${e}/api/v1/customers`,{headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw new Error("Failed to verify API settings. Please check your Syncro URL and API Key.");const o=await n.json();console.log("Syncro Ticket Creator: API settings verified successfully",o),u("API settings verified successfully!","success")}catch(e){console.error("Error verifying API settings:",e),u("Failed to verify API settings. Please try again.","error")}else u("Please enter both Syncro URL and API Key.","error")}async function a(){console.log("Syncro Ticket Creator: populateContacts called");try{u("Loading contacts...");const e=document.getElementById("customer-select").value,t=await async function(e){console.log("Syncro Ticket Creator: fetchSyncroContacts called");const t=await fetch(`${c}/api/v1/customers/${e}/contacts`,{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error("Failed to fetch contacts");return t.json()}(parseInt(e)),n=document.getElementById("contact-select");if(!n)return void console.error("Syncro Ticket Creator: Element with id 'contact-select' not found");n.innerHTML='<option value="">Select a contact</option>',t.forEach((e=>{const t=document.createElement("option");t.value=e.id.toString(),t.textContent=g(e.name),n.appendChild(t)})),y(),async function(){console.log("Syncro Ticket Creator: populateAssets called");try{u("Loading assets...");const e=document.getElementById("customer-select").value,t=await async function(e){console.log("Syncro Ticket Creator: fetchSyncroAssets called");const t=await fetch(`${c}/api/v1/customers/${e}/assets`,{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error("Failed to fetch assets");return t.json()}(parseInt(e)),n=document.getElementById("asset-select");if(!n)return void console.error("Syncro Ticket Creator: Element with id 'asset-select' not found");n.innerHTML='<option value="">Select an asset</option>',t.forEach((e=>{const t=document.createElement("option");t.value=e.id.toString(),t.textContent=g(e.name),n.appendChild(t)})),y()}catch(e){console.error("Error populating assets:",e),u("Failed to load assets. Please try again.","error")}}()}catch(e){console.error("Error populating contacts:",e),u("Failed to load contacts. Please try again.","error")}}async function l(){console.log("Syncro Ticket Creator: createTicket called");try{u("Creating ticket...");const e=await async function(){return console.log("Syncro Ticket Creator: getEmailInfo called"),new Promise((e=>{if("undefined"!=typeof Office&&Office.context&&Office.context.mailbox){const t=Office.context.mailbox.item,n={subject:t?.subject||"",content:"",senderEmail:t?.from?.emailAddress||"",senderName:t?.from?.displayName||""};t?.body.getAsync(Office.CoercionType.Text,(t=>{t.status===Office.AsyncResultStatus.Succeeded&&(n.content=t.value),e(n)}))}else e({subject:"",content:"",senderEmail:"",senderName:""})}))}(),t=document.getElementById("customer-select").value,n=document.getElementById("contact-select").value,s=document.getElementById("asset-select").value,r=document.getElementById("ticket-title").value||e.subject,i=document.getElementById("ticket-message").value||e.content,a={customer_id:parseInt(t),contact_id:parseInt(n),asset_id:s?parseInt(s):null,subject:r,problem_type:"Other",status:"New",comment:i},l=await async function(e){console.log("Syncro Ticket Creator: createSyncroTicket called");const t=await fetch(`${c}/api/v1/tickets`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create ticket");return t.json()}(a);console.log("Ticket created:",l),u("Ticket created successfully!","success")}catch(e){console.error("Error creating ticket:",e),u("Failed to create ticket. Please try again.","error")}}async function d(){console.log("Syncro Ticket Creator: fetchSyncroCustomers called");const e=await fetch(`${c}/api/v1/customers`,{headers:{Authorization:`Bearer ${o}`}});if(!e.ok)throw new Error("Failed to fetch customers");return e.json()}function u(e,t="info"){console.log(`Syncro Ticket Creator: showStatus called - ${t}: ${e}`);const n=document.getElementById("status-message");if(!n){const e=document.createElement("div");e.id="status-message",document.body.insertBefore(e,document.body.firstChild)}const o=n||document.getElementById("status-message");o.textContent=g(e),o.className=`status-message ${t}`,o.style.display="block"}function y(){console.log("Syncro Ticket Creator: hideStatus called");const e=document.getElementById("status-message");e&&(e.style.display="none")}function g(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}e.observe(document.body,{childList:!0,subtree:!0}),"undefined"!=typeof Office?(console.log("Syncro Ticket Creator: Office environment detected"),Office.onReady((e=>{console.log("Syncro Ticket Creator: Office.onReady called",e),e.host===Office.HostType.Outlook&&document.addEventListener("DOMContentLoaded",s)}))):(console.log("Syncro Ticket Creator: Non-Office environment detected"),document.addEventListener("DOMContentLoaded",(()=>{console.log("Syncro Ticket Creator: DOMContentLoaded event fired"),s()})))}(),e=r(14385),t=r.n(e),n=new URL(r(58394),r.b),o=new URL(r(98362),r.b),t()(n),t()(o)}();
//# sourceMappingURL=taskpane.js.map