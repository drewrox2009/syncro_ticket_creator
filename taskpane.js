!function(){"use strict";var e,t,o,n,c={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98362:function(e,t,o){e.exports=o.p+"assets/logo-filled.png"},58394:function(e,t,o){e.exports=o.p+"fd6ebc4970a52eece689.css"}},s={};function r(e){var t=s[e];if(void 0!==t)return t.exports;var o=s[e]={exports:{}};return c[e](o,o.exports,r),o.exports}r.m=c,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var n=o.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=o[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r.b=document.baseURI||self.location.href,function(){function e(){console.log("settings.ts: saveSettings called"),o(document.getElementById("syncro-url").value,document.getElementById("syncro-api-key").value).then((()=>{console.log("settings.ts: Settings saved successfully")})).catch((e=>{console.error("settings.ts: Error saving settings:",e)}))}function t(){console.log("settings.ts: getSyncroSettings called");let e="",t="";return"undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings?(e=Office.context.roamingSettings.get("syncroUrl")||"",t=Office.context.roamingSettings.get("syncroApiKey")||""):(e=localStorage.getItem("syncroUrl")||"",t=localStorage.getItem("syncroApiKey")||""),console.log("settings.ts: Retrieved settings:",{syncroUrl:e,syncroApiKey:t}),{syncroUrl:e,syncroApiKey:t}}function o(e,t){return console.log("settings.ts: saveSyncroSettings called",{syncroUrl:e,syncroApiKey:t}),new Promise(((o,n)=>{"undefined"!=typeof Office&&Office.context&&Office.context.roamingSettings?(Office.context.roamingSettings.set("syncroUrl",e),Office.context.roamingSettings.set("syncroApiKey",t),Office.context.roamingSettings.saveAsync((e=>{e.status===Office.AsyncResultStatus.Succeeded?o():n(e.error)}))):(localStorage.setItem("syncroUrl",e),localStorage.setItem("syncroApiKey",t),o())}))}let n,c;function s(){console.log("Syncro Ticket Creator: initializeApp called"),document.getElementById("create-ticket").onclick=i,async function(){console.log("Syncro Ticket Creator: loadSyncroSettings called");const e=t();console.log("Retrieved settings:",e),n=e.syncroApiKey,c=e.syncroUrl,function(){console.log("Syncro Ticket Creator: showSettingsUI called");const e=document.getElementById("app-body");e?(console.log("Syncro Ticket Creator: app-body element found"),console.log("Syncro Ticket Creator: syncroUrl:",c),console.log("Syncro Ticket Creator: syncroApiKey:",n),e.innerHTML=`\n      <h2>Syncro API Settings</h2>\n      <div class="ms-TextField">\n        <label class="ms-Label" for="syncro-url">Syncro URL</label>\n        <input type="text" id="syncro-url" class="ms-TextField-field" value="${c||""}" required />\n      </div>\n      <div class="ms-TextField">\n        <label class="ms-Label" for="syncro-api-key">Syncro API Key</label>\n        <input type="password" id="syncro-api-key" class="ms-TextField-field" value="${n||""}" required />\n      </div>\n      <div class="ms-TextField">\n        <button id="save-settings" class="ms-Button ms-Button--primary">\n          <span class="ms-Button-label">Save Settings</span>\n        </button>\n      </div>\n    `,document.getElementById("save-settings").onclick=r,console.log("Syncro Ticket Creator: Settings UI rendered")):console.error("Syncro Ticket Creator: Element with id 'app-body' not found")}()}()}async function r(){console.log("Syncro Ticket Creator: saveSettings called");const e=document.getElementById("syncro-url").value,t=document.getElementById("syncro-api-key").value;if(e&&t)try{await o(e,t),c=e,n=t,d("Settings saved successfully. Initializing app...","success"),await async function(){console.log("Syncro Ticket Creator: verifyApiSettings called");try{await l()}catch(e){throw console.error("Error verifying API settings:",e),new Error("Invalid API settings. Please check your Syncro URL and API Key.")}}(),await async function(){console.log("Syncro Ticket Creator: populateCustomers called");try{const e=await l(),t=document.getElementById("customer-select");t.innerHTML='<option value="">Select a customer</option>',e.forEach((e=>{const o=document.createElement("option");o.value=e.id.toString(),o.textContent=y(e.name),t.appendChild(o)})),t.onchange=a}catch(e){throw console.error("Error populating customers:",e),d("Failed to load customers. Please check your Syncro settings.","error"),e}}(),u()}catch(e){console.error("Error saving settings:",e),d("Failed to save settings. Please try again.","error")}else d("Please enter both Syncro URL and API Key.","error")}async function a(){console.log("Syncro Ticket Creator: populateContacts called");try{d("Loading contacts...");const e=document.getElementById("customer-select").value,t=await async function(e){console.log("Syncro Ticket Creator: fetchSyncroContacts called");const t=await fetch(`${c}/api/v1/customers/${e}/contacts`,{headers:{Authorization:`Bearer ${n}`}});if(!t.ok)throw new Error("Failed to fetch contacts");return t.json()}(parseInt(e)),o=document.getElementById("contact-select");o.innerHTML='<option value="">Select a contact</option>',t.forEach((e=>{const t=document.createElement("option");t.value=e.id.toString(),t.textContent=y(e.name),o.appendChild(t)})),u(),async function(){console.log("Syncro Ticket Creator: populateAssets called");try{d("Loading assets...");const e=document.getElementById("customer-select").value,t=await async function(e){console.log("Syncro Ticket Creator: fetchSyncroAssets called");const t=await fetch(`${c}/api/v1/customers/${e}/assets`,{headers:{Authorization:`Bearer ${n}`}});if(!t.ok)throw new Error("Failed to fetch assets");return t.json()}(parseInt(e)),o=document.getElementById("asset-select");o.innerHTML='<option value="">Select an asset</option>',t.forEach((e=>{const t=document.createElement("option");t.value=e.id.toString(),t.textContent=y(e.name),o.appendChild(t)})),u()}catch(e){console.error("Error populating assets:",e),d("Failed to load assets. Please try again.","error")}}()}catch(e){console.error("Error populating contacts:",e),d("Failed to load contacts. Please try again.","error")}}async function i(){console.log("Syncro Ticket Creator: createTicket called");try{d("Creating ticket...");const e=await async function(){return console.log("Syncro Ticket Creator: getEmailInfo called"),new Promise((e=>{if("undefined"!=typeof Office&&Office.context&&Office.context.mailbox){const t=Office.context.mailbox.item,o={subject:t?.subject||"",content:"",senderEmail:t?.from?.emailAddress||"",senderName:t?.from?.displayName||""};t?.body.getAsync(Office.CoercionType.Text,(t=>{t.status===Office.AsyncResultStatus.Succeeded&&(o.content=t.value),e(o)}))}else e({subject:"",content:"",senderEmail:"",senderName:""})}))}(),t=document.getElementById("customer-select").value,o=document.getElementById("contact-select").value,s=document.getElementById("asset-select").value,r=document.getElementById("ticket-title").value||e.subject,a=document.getElementById("ticket-message").value||e.content,i={customer_id:parseInt(t),contact_id:parseInt(o),asset_id:s?parseInt(s):null,subject:r,problem_type:"Other",status:"New",comment:a},l=await async function(e){console.log("Syncro Ticket Creator: createSyncroTicket called");const t=await fetch(`${c}/api/v1/tickets`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create ticket");return t.json()}(i);console.log("Ticket created:",l),d("Ticket created successfully!","success")}catch(e){console.error("Error creating ticket:",e),d("Failed to create ticket. Please try again.","error")}}async function l(){console.log("Syncro Ticket Creator: fetchSyncroCustomers called");const e=await fetch(`${c}/api/v1/customers`,{headers:{Authorization:`Bearer ${n}`}});if(!e.ok)throw new Error("Failed to fetch customers");return e.json()}function d(e,t="info"){console.log(`Syncro Ticket Creator: showStatus called - ${t}: ${e}`);const o=document.getElementById("status-message");if(!o){const e=document.createElement("div");e.id="status-message",document.body.insertBefore(e,document.body.firstChild)}const n=o||document.getElementById("status-message");n.textContent=y(e),n.className=`status-message ${t}`,n.style.display="block"}function u(){console.log("Syncro Ticket Creator: hideStatus called");const e=document.getElementById("status-message");e&&(e.style.display="none")}function y(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}Office.onReady((o=>{if(console.log("settings.ts: Office.onReady called",o),o.host===Office.HostType.Outlook){!function(){console.log("settings.ts: loadSettings called");const e=t().syncroUrl,o=t().syncroApiKey;e&&(document.getElementById("syncro-url").value=e),o&&(document.getElementById("syncro-api-key").value=o)}();const o=document.getElementById("save-settings");o?(o.addEventListener("click",e),console.log("settings.ts: Event listener attached to save-settings button")):console.error("settings.ts: Element with id 'save-settings' not found")}})),"undefined"!=typeof Office?(console.log("Syncro Ticket Creator: Office environment detected"),Office.onReady((e=>{console.log("Syncro Ticket Creator: Office.onReady called",e),e.host===Office.HostType.Outlook&&s()}))):(console.log("Syncro Ticket Creator: Non-Office environment detected"),document.addEventListener("DOMContentLoaded",(()=>{console.log("Syncro Ticket Creator: DOMContentLoaded event fired"),s()})))}(),e=r(14385),t=r.n(e),o=new URL(r(58394),r.b),n=new URL(r(98362),r.b),t()(o),t()(n)}();
//# sourceMappingURL=taskpane.js.map