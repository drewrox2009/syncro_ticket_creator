!function(){"use strict";var t,e,n,o,c={14385:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},98362:function(t,e,n){t.exports=n.p+"assets/logo-filled.png"},58394:function(t,e,n){t.exports=n.p+"fd6ebc4970a52eece689.css"}},s={};function r(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return c[t](n,n.exports,r),n.exports}r.m=c,r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t}(),r.b=document.baseURI||self.location.href,function(){function t(){const t=document.getElementById("syncro-url").value,e=document.getElementById("syncro-api-key").value;Office.context.roamingSettings.set("syncroUrl",t),Office.context.roamingSettings.set("syncroApiKey",e),Office.context.roamingSettings.saveAsync((t=>{t.status===Office.AsyncResultStatus.Succeeded?console.log("Settings saved successfully"):console.error("Error saving settings:",t.error)}))}let e,n;function o(){Office.context.ui.displayDialogAsync("https://drewrox2009.github.io/syncro_ticket_creator/settings/settings.html",{height:60,width:30,displayInIframe:!0},(t=>{t.status===Office.AsyncResultStatus.Failed&&(console.error("Failed to open settings dialog:",t.error),r("Failed to open settings. Please try again.","error"))}))}async function c(){try{r("Loading contacts...");const t=document.getElementById("customer-select").value,o=await async function(t){const o=await fetch(`${n}/api/v1/customers/${t}/contacts`,{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Failed to fetch contacts");return o.json()}(parseInt(t)),c=document.getElementById("contact-select");c.innerHTML='<option value="">Select a contact</option>',o.forEach((t=>{const e=document.createElement("option");e.value=t.id.toString(),e.textContent=i(t.name),c.appendChild(e)})),a(),async function(){try{r("Loading assets...");const t=document.getElementById("customer-select").value,o=await async function(t){const o=await fetch(`${n}/api/v1/customers/${t}/assets`,{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Failed to fetch assets");return o.json()}(parseInt(t)),c=document.getElementById("asset-select");c.innerHTML='<option value="">Select an asset</option>',o.forEach((t=>{const e=document.createElement("option");e.value=t.id.toString(),e.textContent=i(t.name),c.appendChild(e)})),a()}catch(t){console.error("Error populating assets:",t),r("Failed to load assets. Please try again.","error")}}()}catch(t){console.error("Error populating contacts:",t),r("Failed to load contacts. Please try again.","error")}}async function s(){try{r("Creating ticket...");const t=await async function(){return new Promise((t=>{const e=Office.context.mailbox.item,n={subject:e?.subject||"",content:"",senderEmail:e?.from?.emailAddress||"",senderName:e?.from?.displayName||""};e?.body.getAsync(Office.CoercionType.Text,(e=>{e.status===Office.AsyncResultStatus.Succeeded&&(n.content=e.value),t(n)}))}))}(),o=document.getElementById("customer-select").value,c=document.getElementById("contact-select").value,s=document.getElementById("asset-select").value,a=document.getElementById("ticket-title").value||t.subject,i=document.getElementById("ticket-message").value||t.content,u={customer_id:parseInt(o),contact_id:parseInt(c),asset_id:s?parseInt(s):null,subject:a,problem_type:"Other",status:"New",comment:i},l=await async function(t){const o=await fetch(`${n}/api/v1/tickets`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw new Error("Failed to create ticket");return o.json()}(u);console.log("Ticket created:",l),r("Ticket created successfully!","success")}catch(t){console.error("Error creating ticket:",t),r("Failed to create ticket. Please try again.","error")}}function r(t,e="info"){const n=document.getElementById("status-message");if(!n){const t=document.createElement("div");t.id="status-message",document.body.insertBefore(t,document.body.firstChild)}const o=n||document.getElementById("status-message");o.textContent=i(t),o.className=`status-message ${e}`,o.style.display="block"}function a(){const t=document.getElementById("status-message");t&&(t.style.display="none")}function i(t){return t.replace(/[&<>"']/g,(function(t){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t]||t}))}Office.onReady((e=>{e.host===Office.HostType.Outlook&&(document.getElementById("save-settings").onclick=t,function(){const t=Office.context.roamingSettings.get("syncroUrl"),e=Office.context.roamingSettings.get("syncroApiKey");t&&(document.getElementById("syncro-url").value=t),e&&(document.getElementById("syncro-api-key").value=e)}())})),Office.onReady((t=>{t.host===Office.HostType.Outlook&&(document.getElementById("create-ticket").onclick=s,async function(){const t={syncroUrl:Office.context.roamingSettings.get("syncroUrl"),syncroApiKey:Office.context.roamingSettings.get("syncroApiKey")};e=t.syncroApiKey,n=t.syncroUrl,e&&n?(r("Loading customers..."),await async function(){try{const t=await async function(){const t=await fetch(`${n}/api/v1/customers`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to fetch customers");return t.json()}(),o=document.getElementById("customer-select");o.innerHTML='<option value="">Select a customer</option>',t.forEach((t=>{const e=document.createElement("option");e.value=t.id.toString(),e.textContent=i(t.name),o.appendChild(e)})),o.onchange=c}catch(t){console.error("Error populating customers:",t),r("Failed to load customers. Please check your Syncro settings.","error")}}(),a()):(document.getElementById("app-body").innerHTML='\n      <p>Please set up your Syncro settings before using this add-in.</p>\n      <button id="open-settings" class="ms-Button ms-Button--primary">\n        <span class="ms-Button-label">Open Settings</span>\n      </button>\n    ',document.getElementById("open-settings").onclick=o)}())}))}(),t=r(14385),e=r.n(t),n=new URL(r(58394),r.b),o=new URL(r(98362),r.b),e()(n),e()(o)}();
//# sourceMappingURL=taskpane.js.map